<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¸ãƒ£ãƒ³ã‚±ãƒ³æˆ¦ç•¥ãƒãƒˆãƒ«ï½œã‚¸ãƒ£ãƒ³ãƒãƒˆ</title>
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/main.css">
</head>

<body>
    <!-- å…¨ä½“ -->
    <div id="wapper">
        <div id="titleWindow">
            <img id="topImg" src="./img/top.png" alt="">
        </div>
        <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ -->
        <div id="messageWindowMain"></div>
        <!-- ã‚¤ãƒ³ãƒ•ã‚©ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ -->
        <div id="informationWindowMain">
            <div id="informationMessage"></div>
            <div id="informationNextButton">æ¬¡ã¸</div>
        </div>
        <!-- ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ© -->
        <div id="volumeControllerIcon">ğŸ”Š</div>

        <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å‡ºã—ãŸã‚«ãƒ¼ãƒ‰ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ -->
        <div id="userChoiceCardWindow"></div>
        <!-- æ•µã®å‡ºã—ãŸã‚«ãƒ¼ãƒ‰ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ -->
        <div id="enemyChoiceCardWindow"></div>
        <!-- å±±æœ­æƒ…å ±ã‚’ã ã™ -->
        <div id="deckWindowMain">
            <!-- ãƒ‡ãƒƒã‚­æƒ…å ±è©³ç´° -->
            <div id="deckWindowInfo"></div>
            <!-- æ›´æ–°ãƒœã‚¿ãƒ³ï¼ˆã¨ã‚Šã‚ãˆãšï¼‰ -->
            <div id="deckWindowOperation">æ›´æ–°</div>
        </div>
        <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æƒ…å ±æ  -->
        <div id="userWindowMain">
            <!-- Status -->
            <div id="userStatus">
                <p>ã‚ãªãŸ</p>
                <p id="userHP">hp</p>
                <p id="userAttackInfo"></p>
            </div>
            <!-- æ‰‹æŒã¡ã®ã‚«ãƒ¼ãƒ‰ -->
            <div id="userCards">
                <ul id="userCardsList">
                </ul>
            </div>
        </div>
        <!-- æ•µã®æƒ…å ±æ  -->
        <div id="enemyWindowMain">

            <!-- æ•µStatus -->
            <div id="enemyStatus">
                <p id="enemyName">ã‚¹ãƒ©ã‚¤ãƒ </p>
                <p id="enemyHP">hp</p>
                <p id="enemyAttackInfo"></p>
            </div>

            <!-- æ•µæ‰‹æœ­ -->
            <div id="enemyCards">
                <ul id="enemyCardsList">
                </ul>
            </div>
        </div>
    </div>
    <!-- jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script>
        const hoverSE = new Audio('./audio/8bitbtn1.mp3');
        const clickSE = new Audio('./audio/8bitbtn2.mp3');
        const damageSE01 = new Audio('./audio/damageA.mp3');
        const damageSE02 = new Audio('./audio/damageB.mp3');
        const recoverySE = new Audio('./audio/recovery.mp3');
        const bgmAuto = new Audio('./audio/Future_1.mp3');
        $("#messageWindowMain").html(
            `<p>ã‚¸ãƒ£ãƒ³ãƒãƒˆã«ã‚ˆã†ã“ãï¼</p>
            <p>ã€Œã‚²ãƒ¼ãƒ èª¬æ˜ã€</p>
            <p>ã˜ã‚ƒã‚“ã‘ã‚“ã‚«ãƒ¼ãƒ‰ã‚’å¼•ã„ã¦ã€å‡ºã™ã‚«ãƒ¼ãƒ‰ã‚’æ±ºã‚ã‚ˆã†</p>
            <p>ã˜ã‚ƒã‚“ã‘ã‚“ã§å‹ã¡è² ã‘ã‚’æ±ºã‚ãŸå¾Œã€æ”»æ’ƒåŠ›ã€ŒğŸ’ªã€åˆ†è² ã‘ãŸã»ã†ã®ä½“åŠ›ğŸ’—ãŒæ¸›ã‚‹ãï¼</p>
            <p>ç›¸æ‰‹ã‚‚æ‰‹æœ­ã‹ã‚‰ã©ã‚Œã‹ã‚’å‡ºã—ã¦ãã‚‹ã‹ã‚‰ã€å‹ã¦ãã†ãªã‚«ãƒ¼ãƒ‰ã‚’é¸ã‚“ã§å‡ºãã†ï¼</p>
            <p>ã‚¹ãƒ†ãƒ¼ã‚¸ãŒé€²ã‚€ã¨ç›¸æ‰‹ã®æ‰‹æœ­ã‚„ä½“åŠ›ğŸ’—ãŒå¢—ãˆã‚‹ãï¼ é ‘å¼µã£ã¦ï¼“é€£å‹ã‚’ç›®æŒ‡ãã†ï¼</p>
            <p>ç‰¹æ®ŠãªåŠ¹æœã®ä»˜ã„ãŸã‚«ãƒ¼ãƒ‰ã‚‚ç™»å ´ã™ã‚‹ã‚ˆï¼</p>
            <p>ç”»é¢ã‚¯ãƒªãƒƒã‚¯ã§ã‚²ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆï¼ï¼ˆBGMã€SEæµã‚Œã¾ã™ï¼‰</p>`
        );
        $("#titleWindow").on('click', function () {
            bgmAuto.play();
            $("#titleWindow").css('display', 'none');
            $("#messageWindowMain").html(
                `<p>å·¦ä¸‹ã®æ‰‹æœ­ã®ä¸­ã‹ã‚‰å ´ã«å‡ºã™ã‚«ãƒ¼ãƒ‰ã‚’é¸ã‚“ã§ä¸‹ã•ã„</p>
            <p>ã˜ã‚ƒã‚“ã‘ã‚“ã§å‹ã£ãŸã»ã†ã®ğŸ’ªã®åˆ†ã ã‘è² ã‘ãŸã»ã†ã®ğŸ’—ã‚’æ¸›ã‚‰ã—ã¾ã™</p>`
            );
        });
        bgmAuto.loop = true;

        let bgmPlaying = true;
        // ğŸ”‡ã‚¢ã‚¤ã‚³ãƒ³ã§å†ç”Ÿåœæ­¢å‡¦ç†
        $("#volumeControllerIcon").on('click', function () {
            if (bgmPlaying) {
                bgmAuto.pause();
                bgmPlaying = false;
                $("#volumeControllerIcon").text("ğŸ”‡");
            } else {
                bgmAuto.play();
                bgmPlaying = true;
                $("#volumeControllerIcon").text("ğŸ”Š");
            }
        });

        // ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¸æ•°ã‚’ç®¡ç†ï¼ˆï¼“ã‚¹ãƒ†ãƒ¼ã‚¸ï¼‰
        let stageNumber = 0;
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½“åŠ›ã‚’è¨­å®š
        let userHP = 15;
        $("#userHP").text("ğŸ’—:" + userHP);
        // æ•µã®ä½“åŠ›ã‚’è¨­å®š
        let enemyHP = 10;
        $("#enemyHP").text("ğŸ’—:" + enemyHP);

        // æ”»æ’ƒåŠ›ã‚¢ãƒƒãƒ—ç®¡ç†Flag
        let userAttackUp = false;
        let enemyAttackUp = false;

        // ã‚«ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¦æ‰‹æœ­ã«è¿½åŠ ã™ã‚‹å‡¦ç†ï¼ˆ5æšã¾ã§
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å±±æœ­ã‚’20æšä½œè£½
        let userDeck = createDeck(20);
        // æ•µã®å±±æœ­ã‚’ä½œæˆï¼ˆï¼‘ï¼æšï¼‰
        let enemyDeck = createDeck(10);

        // æ‰‹æœ­5æšå¼•ã„ã¦ãƒ‡ãƒƒã‚­ã‹ã‚‰å¼•ã„ãŸã‚«ãƒ¼ãƒ‰ã‚’æ¶ˆã™
        // æ‰‹æœ­ç”¨ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é…åˆ—ã§ä¿å­˜ï¼ˆï¼•æšï¼‰
        let userHandsCard = [];
        userDeckDraw(5);
        for (let i = 0; i < userHandsCard.length; i++) {
            $("#userCardsList").append(`<li id="userHandsCardNumber${i}" class="userHandsCardGroup">${handsDisplay(userHandsCard[i])}</li>`);
        }

        // æ•µã®æ‰‹æœ­æƒ…å ±ã‚’å‡ºã™
        // 3æšå¼•ã„ã¦æƒ…å ±ã‚’å‡ºã—ã¦ãŠã
        let enemyHandsCard = [];
        enemyDeckDraw(3);
        for (let i = 0; i < enemyHandsCard.length; i++) {
            $("#enemyCardsList").append(`<li id="enemyHandsCardNumber${i}" class="enemyHandsCardGroup">${handsDisplay(enemyHandsCard[i])}</li>`);
        }

        // ãƒ‡ãƒƒã‚­æ›´æ–°ãƒœã‚¿ãƒ³æŠ¼ã—ãŸã¨ãã®å‡¦ç†
        // ã®ã¡ã«æ‰‹æœ­ã‚’å¼•ã„ãŸã‚‰æ›´æ–°ã¨ã™ã‚‹
        // è¿½åŠ ã§å¼·ã„ã‚«ãƒ¼ãƒ‰ã¨å…¥ã‚Œæ›¿ãˆã¦ã€ã‚’æƒ³å®šã—ã¦ãŸã‘ã©ç´æœŸã®ãŸã‚ã‚ªãƒŸãƒƒãƒˆ
        $("#deckWindowOperation").on('click', function () {
            $("#deckWindowInfo").text(`ãƒ‡ãƒƒã‚­æšæ•°ã¯ã€Œ${userDeck.length}ã€æšã§ã™`);
            // console.log("æ›´æ–°ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã«ã‚ˆã‚Šç”»é¢è¡¨ç¤ºã‚’æ›´æ–°ã—ã¾ã—ãŸ");
        });

        // æ¨ã¦æœ­ç®¡ç†
        let userDumpCards = [];
        let enemyDumpCards = [];

        // æ‰‹æœ­ã‚«ãƒ¼ã‚½ãƒ«ã‚ªãƒ³ã§SE
        $("#userCardsList").on("mouseenter", '.userHandsCardGroup', function () {
            console.log("ãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼");
            hoverSE.pause();
            hoverSE.currentTime = 0;
            hoverSE.play();
        });
        // æ‰‹æœ­ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ãã©ã‚Œã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã‹ãƒŠãƒ³ãƒãƒ¼ã‚’å–å¾—
        $("#userCardsList").on('click', '.userHandsCardGroup', function () {
            // SEå†ç”Ÿ
            console.log("ãƒã‚¦ã‚¹ã‚¯ãƒªãƒƒã‚¯");

            clickSE.pause();
            clickSE.currentTime = 0;
            clickSE.play();
            const num = $(this).index();
            // ãƒªã‚¹ãƒˆã®ç•ªå·ã®ã¨ã“ã‚ã®æ‰‹æœ­æƒ…å ±ã‚’å‰Šé™¤
            const usedCard = userHandsCard.splice(num, 1);

            // ä½¿ç”¨ã—ãŸã‚«ãƒ¼ãƒ‰æƒ…å ±ã‚’æ¨ã¦æœ­é…åˆ—ã«è¿½åŠ 
            userDumpCards[userDumpCards.length] = usedCard[0];

            // é¸ã‚“ã ã‚«ãƒ¼ãƒ‰ã‚’ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å‡ºã™
            playCard(usedCard, 0);

            // å‰Šé™¤ã—ãŸè¦ç´ 
            // liè¦ç´ ã‚’ä¸€åº¦æ¶ˆã™
            $("#userCardsList").html("");

            for (let i = 0; i < userHandsCard.length; i++) {
                // liè¦ç´ ã‚’æ”¹ã‚ã¦æ»ãè¾¼ã‚€
                $("#userCardsList").append(`<li id="userHandsCardNumber${i}" class="userHandsCardGroup">${handsDisplay(userHandsCard[i])}</li>`);
            }

            // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®é¸æŠã«åˆã‚ã›ã¦æ•µã‚‚ã‚«ãƒ¼ãƒ‰ã‚’å‡ºã™
            const randomEnemyCard = Math.floor(Math.random() * enemyHandsCard.length);
            const enemyUsedCard = enemyHandsCard.splice(randomEnemyCard, 1);

            // é¸ã‚“ã ã‚«ãƒ¼ãƒ‰ã‚’ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å‡ºã™
            playCard(enemyUsedCard, 1);
            $("#enemyCardsList").html("");
            for (let i = 0; i < enemyHandsCard.length; i++) {
                $("#enemyCardsList").append(`<li id="enemyHandsCardNumber${i}" class="enemyHandsCardGroup">${handsDisplay(enemyHandsCard[i])}</li>`);
            }
            // ä½¿ç”¨ã—ãŸã‚«ãƒ¼ãƒ‰æƒ…å ±ã‚’æ¨ã¦æœ­é…åˆ—ã«è¿½åŠ 
            enemyDumpCards[enemyDumpCards.length] = enemyUsedCard[0];

            // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ¶ˆå»
            $("#messageWindowMain").html(``);
            $("#messageWindowMain").css("font-size", "36px");
            // å‹æ•—åˆ¤å®š
            if (usedCard[0].hand === enemyUsedCard[0].hand) {
                // console.log("ã‚ã„ã“ã§ãã®ä»–å‡¦ç†ãªã—");
                $("#messageWindowMain").append(`<p>ã‚ã„ã“</p>`);
                $("#userChoiceCardWindow").append(`<p>ï¼¤ï¼²ï¼¡ï¼·</p>`);
            } else if ((usedCard[0].hand === 1 && enemyUsedCard[0].hand === 2)
                || (usedCard[0].hand === 2 && enemyUsedCard[0].hand === 3)
                || (usedCard[0].hand === 3 && enemyUsedCard[0].hand === 1)) {
                // console.log("ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å‹ã¡");
                $("#userChoiceCardWindow").append(`<p>ï¼·ï¼©ï¼®ï¼ï¼</p>`);
                if (usedCard[0].effect === 7) {
                    userHP++;
                    recoverySE.play();
                    $("#messageWindowMain").append(`<p>ã‚ãªãŸã®ğŸ’—ã‚’ï¼‘å›å¾©</p>`);
                }
                if (usedCard[0].effect === 8) {
                    userHP += 2;
                    recoverySE.play();
                    $("#messageWindowMain").append(`<p>ã‚ãªãŸã®ğŸ’—ã‚’ï¼’å›å¾©</p>`);
                }
                if (enemyUsedCard[0].effect === 9) {
                    enemyHP++;
                    $("#messageWindowMain").append(`<p>ç›¸æ‰‹ã¯ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’ï¼‘è»½æ¸›ã—ã¾ã—ãŸ</p>`);
                }
                if (userAttackUp) {
                    enemyHP -= 2;
                    damageSE02.play();
                    $("#messageWindowMain").append(`<p>ä¼šå¿ƒã®ä¸€æ’ƒï¼ï¼‹ï¼’ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼</p>`);
                }
                enemyHP -= usedCard[0].attack;
                $("#messageWindowMain").append(`<p>ã˜ã‚ƒã‚“ã‘ã‚“ã«å‹ã£ãŸï¼ç›¸æ‰‹ã®ğŸ’—ã«ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼</p>`);
                damageSE01.play();
            } else if ((usedCard[0].hand === 2 && enemyUsedCard[0].hand === 1)
                || (usedCard[0].hand === 3 && enemyUsedCard[0].hand === 2)
                || (usedCard[0].hand === 1 && enemyUsedCard[0].hand === 3)) {
                // console.log("ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è² ã‘")
                $("#userChoiceCardWindow").append(`<p>ï¼¬ï¼¯ï¼³ï¼³ãƒ»ãƒ»ãƒ»</p>`);
                if (enemyUsedCard[0].effect === 7) {
                    enemyHP++;
                    recoverySE.play();
                    $("#messageWindowMain").append(`<p>ç›¸æ‰‹ã¯ğŸ’—ã‚’ï¼‘å›å¾©</p>`);
                }
                if (enemyUsedCard[0].effect === 8) {
                    enemyHP += 2;
                    recoverySE.play();
                    $("#messageWindowMain").append(`<p>ç›¸æ‰‹ã¯ğŸ’—ã‚’ï¼’å›å¾©</p>`);
                }
                if (usedCard[0].effect === 9) {
                    userHP++;
                    $("#messageWindowMain").append(`<p>ã‚ãªãŸã¯ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’ï¼‘è»½æ¸›ã—ã¾ã—ãŸ</p>`);
                }
                if (enemyAttackUp) {
                    userHP -= 2;
                    damageSE02.play();
                    $("#messageWindowMain").append(`<p>ç—›æ¨ã®ä¸€æ’ƒï¼ğŸ’—ã«è¿½åŠ ã§ï¼’ãƒ€ãƒ¡ãƒ¼ã‚¸</p>`);
                }
                userHP -= enemyUsedCard[0].attack;
                $("#messageWindowMain").append(`<p>ã˜ã‚ƒã‚“ã‘ã‚“ã«è² ã‘ã¦ğŸ’—ã‚’å¤±ã£ãŸï¼</p>`);
                damageSE01.play();
            }

            $("#userAttackInfo").text("");
            userAttackUp = false;
            $("#enemyAttackInfo").text("");
            enemyAttackUp = false;

            // console.log("æ•µä½“åŠ›ãŒ" + enemyHP + "ã«ãªã‚Šã¾ã—ãŸ");
            $("#userHP").text("ğŸ’—:" + userHP);
            $("#enemyHP").text("ğŸ’—:" + enemyHP);

            if (usedCard[0].effect === 10) {
                userAttackUp = true;
                $("#userAttackInfo").text("æ¬¡å›ã®ğŸ’ªï¼’ã‚¢ãƒƒãƒ—ï¼");
            }
            if (enemyUsedCard[0].effect === 10) {
                enemyAttackUp = true;
                $("#enemyAttackInfo").text("æ¬¡å›ã®ğŸ’ªï¼’ã‚¢ãƒƒãƒ—ï¼");
            }


            // ä½“åŠ›ãŒï¼ã«ãªã£ãŸã‹ã®åˆ¤å®š
            if (userHP <= 0) {
                $("#userChoiceCardWindow").html(``);
                $("#enemyChoiceCardWindow").html(``);
                $("#messageWindowMain").html(``);
                // informationWindowMainã‚’è¡¨ç¤º
                $("#informationWindowMain").css("display", "block");
                // ãƒ†ã‚­ã‚¹ãƒˆã‚’è¡¨ç¤º
                $("#informationMessage").text("ã‚ãªãŸã®ä½“åŠ›ãŒãªããªã‚Šã¾ã—ãŸï¼è² ã‘ãƒ»ãƒ»ãƒ»");
                // æ‰‹æœ­ã®ã‚«ãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã§ããªãã™ã‚‹
                $(".userHandsCardGroup").prop("disabled", true);
                // ãƒªã‚»ãƒƒãƒˆã—ã¦æœ€åˆã‹ã‚‰ãƒ—ãƒ¬ã‚¤ã™ã‚‹å‡¦ç†ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸æ•°ã ã‘å¼•ç¶™ãï¼‰
                // æ¬¡ã¸ãƒœã‚¿ãƒ³ã®æŒ™å‹•ã‚’ç®¡ç†
                nextButtonFlag = 2; // è² ã‘ã¦ã„ã‚‹
                return false;
            }
            if (enemyHP <= 0) {
                $("#userChoiceCardWindow").html(``);
                $("#enemyChoiceCardWindow").html(``);
                $("#messageWindowMain").html(``);
                $("#informationWindowMain").css("display", "block");
                $("#informationMessage").text("ç›¸æ‰‹ã®ä½“åŠ›ãŒãªããªã‚Šã¾ã—ãŸï¼å‹ã¡ï¼");
                $(".userHandsCardGroup").prop("disabled", true);
                // æ¬¡ã¸ãƒœã‚¿ãƒ³ã®æŒ™å‹•ã‚’ç®¡ç†
                nextButtonFlag = 1; // å‹åˆ©ã—ã¦ã„ã‚‹
                return false;
            }

            // å‹æ•—åˆ¤å®šå¾Œã«å±±æœ­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’å¼•ã
            userDeckDraw(5);
            $("#userCardsList").html("");
            for (let i = 0; i < userHandsCard.length; i++) {
                $("#userCardsList").append(`<li id="userHandsCardNumber${i}" class="userHandsCardGroup">${handsDisplay(userHandsCard[i])}</li>`);
            }
            enemyDeckDraw(3 + stageNumber);
            $("#enemyCardsList").html("");
            for (let i = 0; i < enemyHandsCard.length; i++) {
                $("#enemyCardsList").append(`<li id="enemyHandsCardNumber${i}" class="enemyHandsCardGroup">${handsDisplay(enemyHandsCard[i])}</li>`);
            }
        });

        // ãƒã‚¯ã‚¹ãƒˆãƒœã‚¿ãƒ³ã®æŒ™å‹•ã‚’ç®¡ç†ã™ãƒ•ãƒ©ã‚°
        let nextButtonFlag = 0;
        $("#informationNextButton").on("mouseenter", function () {
            console.log("ãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼");
            hoverSE.play();
        });

        $("#informationNextButton").on("click", function () {
            console.log("ãƒã‚¦ã‚¹ã‚¯ãƒªãƒƒã‚¯");
            clickSE.play();

            // 1:å‹åˆ©ã—ã¦ã„ã‚‹ã¨ã
            if (nextButtonFlag === 1) {
                nextButtonFlag = 0;
                if (stageNumber === 2) { // 3ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¯ãƒªã‚¢

                    $("#informationMessage").html(`<p>æœ€å¾Œã®æ•µã‚’å€’ã—ã¾ã—ãŸï¼ã‚²ãƒ¼ãƒ ã‚¯ãƒªã‚¢ï¼</p><p>ã‚¿ã‚¤ãƒˆãƒ«ã«æˆ»ã‚Šã¾ã™</p>`);
                    nextButtonFlag = 3;
                    return false;

                }
                // ãƒªã‚»ãƒƒãƒˆã—ã¦æœ€åˆã‹ã‚‰ãƒ—ãƒ¬ã‚¤ã™ã‚‹å‡¦ç†ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸ã‚’é€²ã‚ã‚‹ï¼‰
                stageNumber++;
                // ãƒ‡ãƒƒã‚­ã€æ‰‹æœ­ã€æ¨ã¦æœ­å…¨å‰Šé™¤
                enemyDeck.splice(0, enemyDeck.length);
                enemyHandsCard.splice(0, enemyHandsCard.length);
                enemyDumpCards.splice(0, enemyDumpCards.length);
                // ï¼‘ï¼æšãƒ‡ãƒƒã‚­ä½œæˆ
                enemyDeck = createDeck(10);
                // ãƒ‡ãƒƒã‚­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’å¼•ã„ã¦è¡¨ç¤º
                enemyDeckDraw(3 + stageNumber);
                $("#enemyCardsList").html("");
                for (let i = 0; i < enemyHandsCard.length; i++) {
                    $("#enemyCardsList").append(`<li id="enemyHandsCardNumber${i}" class="enemyHandsCardGroup">${handsDisplay(enemyHandsCard[i])}</li>`);
                }
                if (stageNumber === 1) {
                    $("#enemyName").text("ã‚´ãƒ–ãƒªãƒ³");
                    $("#enemyStatus").css('background-image', 'url(./img/fantasy_goblin.png)');
                } else if (stageNumber === 2) {
                    $("#enemyName").text("ã‚ªãƒ¼ã‚¯");
                    $("#enemyStatus").css("background-image", "url(./img/fantasy_orc.png)");
                }
                // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‡ãƒƒã‚­ã‚’ä¿å­˜ã—ã¦ä½¿ã„ã¾ã‚ã™å‡¦ç†ã¯ã‚ªãƒŸãƒƒãƒˆ å¼·ã„ã‚«ãƒ¼ãƒ‰ã¨å…¥ã‚Œæ›¿ãˆã‚‹ãªã©ã®æˆ¦ç•¥æ€§ã¯ã„ã£ãŸã‚“ä¿ç•™
                // ã¨ã‚Šã‚ãˆãšãƒ‡ãƒƒã‚­å…¨å‰Šé™¤ã—ã¦å¼•ãç›´ã™å‡¦ç†ã§
                // ãƒ‡ãƒƒã‚­ã€æ‰‹æœ­ã€æ¨ã¦æœ­å…¨å‰Šé™¤
                userDeck.splice(0, userDeck.length);
                userHandsCard.splice(0, userHandsCard.length);
                userDumpCards.splice(0, userDumpCards.length);
                // ï¼‘ï¼æšãƒ‡ãƒƒã‚­ä½œæˆ
                userDeck = createDeck(20);
                // ãƒ‡ãƒƒã‚­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’å¼•ã„ã¦è¡¨ç¤º
                userDeckDraw(5);
                $("#userCardsList").html("");
                for (let i = 0; i < userHandsCard.length; i++) {
                    // liè¦ç´ ã‚’æ”¹ã‚ã¦æ»ãè¾¼ã‚€
                    $("#userCardsList").append(`<li id="userHandsCardNumber${i}" class="userHandsCardGroup">${handsDisplay(userHandsCard[i])}</li>`);
                }
                enemyHP = 10 + (stageNumber * 5);
                userHP = 15;
                $("#enemyHP").text("ğŸ’—:" + enemyHP);
                $("#userHP").text("ğŸ’—:" + userHP);
            } else if (nextButtonFlag === 2) { // è² ã‘ã¦ã„ã‚‹ã¨ã
                nextButtonFlag = 0;
                stageNumber = 0;
                $("#enemyName").text("ã‚¹ãƒ©ã‚¤ãƒ ");
                $("#enemyStatus").css("background-image", "url(./img/fantasy_game_character_slime.png)");
                // ãƒ‡ãƒƒã‚­ã€æ‰‹æœ­ã€æ¨ã¦æœ­å…¨å‰Šé™¤
                userDeck.splice(0, userDeck.length);
                userHandsCard.splice(0, userHandsCard.length);
                userDumpCards.splice(0, userDumpCards.length);
                // ï¼’ï¼æšãƒ‡ãƒƒã‚­ä½œæˆ
                userDeck = createDeck(20);
                // ãƒ‡ãƒƒã‚­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’å¼•ã„ã¦è¡¨ç¤º
                userDeckDraw(5);
                $("#userCardsList").html("");
                for (let i = 0; i < userHandsCard.length; i++) {
                    // liè¦ç´ ã‚’æ”¹ã‚ã¦æ»ãè¾¼ã‚€
                    $("#userCardsList").append(`<li id="userHandsCardNumber${i}" class="userHandsCardGroup">${handsDisplay(userHandsCard[i])}</li>`);
                }
                // ãƒ‡ãƒƒã‚­ã€æ‰‹æœ­ã€æ¨ã¦æœ­å…¨å‰Šé™¤
                enemyDeck.splice(0, enemyDeck.length);
                enemyHandsCard.splice(0, enemyHandsCard.length);
                enemyDumpCards.splice(0, enemyDumpCards.length);
                // ï¼‘ï¼æšãƒ‡ãƒƒã‚­ä½œæˆ
                enemyDeck = createDeck(10);
                // ãƒ‡ãƒƒã‚­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’å¼•ã„ã¦è¡¨ç¤º
                enemyDeckDraw(3 + stageNumber);
                $("#enemyCardsList").html("");
                for (let i = 0; i < enemyHandsCard.length; i++) {
                    $("#enemyCardsList").append(`<li id="enemyHandsCardNumber${i}" class="enemyHandsCardGroup">${handsDisplay(enemyHandsCard[i])}</li>`);
                }
                enemyHP = 10 + (stageNumber * 5);
                userHP = 15;
                $("#enemyHP").text("ğŸ’—:" + enemyHP);
                $("#userHP").text("ğŸ’—:" + userHP);
            }
            // ã‚¤ãƒ³ãƒ•ã‚©ã‚’æ¶ˆã™
            // informationWindowMainã‚’è¡¨ç¤º
            $("#informationWindowMain").css("display", "none");
            if (nextButtonFlag === 3) {
                location.reload();
            }
        });

        // ä»¥ä¸‹ã€é–¢æ•°ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½

        function handsDisplay(handsCard) {
            let handsInfo = "";
            if (handsCard.hand === 1) {
                handsInfo += "âœŠ";
            } else if (handsCard.hand === 2) {
                handsInfo += "âœŒ";
            } else if (handsCard.hand === 3) {
                handsInfo += "âœ‹";
            }
            handsInfo += "/ ğŸ’ª:" + handsCard.attack;
            if (handsCard.effect < 7) {
                handsInfo += "/ åŠ¹æœï¼šãªã—";
            } else if (handsCard.effect === 7) {
                handsInfo += "/ åŠ¹æœï¼šğŸ’—ï¼‹ï¼‘";
            } else if (handsCard.effect === 8) {
                handsInfo += "/ åŠ¹æœï¼šğŸ’—ï¼‹ï¼’";
            } else if (handsCard.effect === 9) {
                handsInfo += "/ åŠ¹æœï¼šè»½æ¸›ï¼‘";
            } else if (handsCard.effect === 10) {
                handsInfo += "/ åŠ¹æœï¼šæ¬¡ğŸ’ªï¼‹ï¼’";
            }
            return handsInfo;

        }


        function createDeck(deckCount) {
            const anyoneDeck = [];
            for (let i = 0; i < deckCount; i++) {
                anyoneDeck[i] = createCards();
                // deckWindowMainã«è¡¨ç¤º
                $("#deckWindowMain").append(anyoneDeck.length + "æš|");
                if (anyoneDeck[i].hand === 1) {
                    $("#deckWindowMain").append("âœŠ|");
                } else if (anyoneDeck[i].hand === 2) {
                    $("#deckWindowMain").append("âœŒ|");
                } else {
                    $("#deckWindowMain").append("âœ‹|");
                }
            }
            return anyoneDeck;
        }

        function userDeckDraw(num) { // å¼•æ•°ã§æ‰‹æœ­ãƒ‡ãƒƒã‚­å—ã‘å–ã£ã¦è¿”ã™ã®ãŒå¤§å¤‰ã ã£ãŸã®ã§ç›´æ¥å¤‰æ•°ã‚’æ“ä½œã—ã¾ã™ï¼ˆã»ã‚“ã¨ã¯ã ã‚ãã†
            // console.log("ãƒ‰ãƒ­ãƒ¼æ“ä½œå‰ã®æ‰‹æœ­æšæ•°ï¼š" + userHandsCard.length);
            for (let i = 0; i < num; i++) {
                // console.log("æ‰‹æœ­ä½•æšç›®ã®å‡¦ç†ã‹ï¼š" + i)
                if (userHandsCard.length <= i) {
                    // ãƒ‡ãƒƒã‚­ã‹ã‚‰ä½•ã‚’å¼•ãã‹ãƒ©ãƒ³ãƒ€ãƒ ã§æŒ‡å®šã™ã‚‹
                    const r = Math.floor(Math.random() * userDeck.length);
                    userHandsCard[i] = userDeck[r];
                    userDeck.splice(r, 1);
                    // consoleCards(userHandsCard[i]);
                    // ãƒ‡ãƒƒã‚­ãŒï¼ã«ãªã£ãŸã‚‰æ¨ã¦æœ­ã‚«ãƒ¼ãƒ‰ã‚’ãƒ‡ãƒƒã‚­ã«æˆ»ã™
                    if (userDeck.length <= 0) {
                        console.log("ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒƒã‚­æšæ•°ã‚¼ãƒ­ã«ãªã‚Šã¾ã—ãŸã€‚æ¨ã¦æœ­ã‹ã‚‰ãƒ‡ãƒƒã‚­ã«æˆ»ã—ã¾ã™");
                        console.log(userDeck);
                        console.log(userDumpCards);
                        for (let i2 = 0; i2 < userDumpCards.length; i2++) {
                            userDeck[i2] = userDumpCards[i2];
                        }
                        console.log(userDeck);
                        console.log(userDumpCards);
                        userDumpCards.splice(0, userDumpCards.length);
                        console.log(userDumpCards);
                    }
                } else {
                    // console.log("userHandsCard[i]:ã¯ã™ã§ã«å­˜åœ¨ã™ã‚‹ã®ã§ã‚«ãƒ¼ãƒ‰ã‚’å¼•ã‹ãªã„");
                    // consoleCards(userHandsCard[i]);
                }
                // console.log("å±±æœ­æ®‹ã‚Šæšæ•°" + userDeck.length);
            }
            console.log("ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒƒã‚­æ®‹ã‚Šæšæ•°ï¼š" + userDeck.length);
        }

        function enemyDeckDraw(num) { // 
            // console.log("ãƒ‰ãƒ­ãƒ¼æ“ä½œå‰ã®æ‰‹æœ­æšæ•°ï¼š" + enemyHandsCard.length);
            for (let i = 0; i < num; i++) {
                // console.log("æ‰‹æœ­ä½•æšç›®ã®å‡¦ç†ã‹ï¼š" + i)
                if (enemyHandsCard.length <= i) {
                    const r = Math.floor(Math.random() * enemyDeck.length);
                    enemyHandsCard[i] = enemyDeck[r]; // ã„ã£ãŸã‚“ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼‘ç•ªã‚’æ ¼ç´
                    enemyDeck.splice(r, 1);
                    // consoleCards(enemyHandsCard[i]);
                    if (enemyDeck.length <= 0) {
                        console.log("ã‚¨ãƒãƒŸãƒ¼ãƒ‡ãƒƒã‚­æšæ•°ã‚¼ãƒ­ã«ãªã‚Šã¾ã—ãŸã€‚æ¨ã¦æœ­ã‹ã‚‰ãƒ‡ãƒƒã‚­ã«æˆ»ã—ã¾ã™");
                        console.log(enemyDeck);
                        console.log(enemyDumpCards);
                        for (let i2 = 0; i2 < enemyDumpCards.length; i2++) {
                            enemyDeck[i2] = enemyDumpCards[i2];
                        }
                        console.log(enemyDeck);
                        console.log(enemyDumpCards);
                        enemyDumpCards.splice(0, enemyDumpCards.length);
                        console.log(enemyDumpCards);
                    }
                } else {
                    // console.log("enemyHandsCard[i]:ã¯ã™ã§ã«å­˜åœ¨ã™ã‚‹ã®ã§ã‚«ãƒ¼ãƒ‰ã‚’å¼•ã‹ãªã„");
                    // consoleCards(enemyHandsCard[i]);
                }
                // console.log("å±±æœ­æ®‹ã‚Šæšæ•°" + enemyDeck.length);
            }
            console.log("æ•µãƒ‡ãƒƒã‚­æ®‹ã‚Šæšæ•°ï¼š" + enemyDeck.length);
        }

        // ã‚«ãƒ¼ãƒ‰ã®æƒ…å ±ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤º
        function consoleCards(card) {
            console.log("card.handï¼š" + card.hand);
        }

        // ã‚«ãƒ¼ãƒ‰ä¸€æšã®æƒ…å ±ã‚’ä½œã£ã¦è¿”ã™
        function createCards() {
            const handRandomNumber = Math.ceil(Math.random() * 3);
            const effectRandomNumber = Math.ceil(Math.random() * 10);
            const attackRandomNumber = Math.ceil(Math.random() * 5);
            // ã‚«ãƒ¼ãƒ‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚°ãƒ¼ãƒãƒ§ã‚­ãƒ‘ãƒ¼ã¨åŠ¹æœã¨æ”»æ’ƒåŠ›ã‚’æŒãŸã›ã‚‹
            const cardInfo = {
                hand: handRandomNumber,
                effect: effectRandomNumber,
                attack: attackRandomNumber
            };
            return cardInfo;
        }

        // ä¸­å¤®ã«ã‚«ãƒ¼ãƒ‰æƒ…å ±å‡ºã™
        function playCard(cardStatus, player) {
            console.log(cardStatus);
            let playCardHand = "";
            let playCardEffectText = "";
            let playerInfo = "";
            if (player === 0) {
                playerInfo = "#userChoiceCardWindow";
            } else {
                playerInfo = "#enemyChoiceCardWindow";
            }
            if (cardStatus[0].hand === 1) {
                playCardHand = "âœŠ";
            } else if (cardStatus[0].hand === 2) {
                playCardHand = "âœŒ";
            } else if (cardStatus[0].hand === 3) {
                playCardHand = "âœ‹";
            }
            if (cardStatus[0].effect < 7) {
                playCardEffectText = "åŠ¹æœï¼šãªã—";
            } else if (cardStatus[0].effect === 7) {
                playCardEffectText = "åŠ¹æœï¼šå‹åˆ©æ™‚ã«ğŸ’—ã‚’ï¼‘å›å¾©";
            } else if (cardStatus[0].effect === 8) {
                playCardEffectText = "åŠ¹æœï¼šå‹åˆ©æ™‚ã«ğŸ’—ã‚’ï¼’å›å¾©";
            } else if (cardStatus[0].effect === 9) {
                playCardEffectText = "åŠ¹æœï¼šæ•—åŒ—æ™‚ã«ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼‘è»½æ¸›";
            } else if (cardStatus[0].effect === 10) {
                playCardEffectText = "åŠ¹æœï¼šæ¬¡å›ã®ğŸ’ªã‚’ï¼’ãƒ—ãƒ©ã‚¹";
            }
            $(playerInfo).html(
                `<p>${playCardHand}</p>
                <p>ğŸ’ªï¼š${cardStatus[0].attack}</p>
                <p>${playCardEffectText}</p>
                `
            );
        }


        // ä»¥ä¸‹ã€ä½™è£•ãŒã‚ã£ãŸã‚‰é–¢æ•°åŒ–ã—ãŸã‹ã£ãŸã‚‚ã®(ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®å¯èª­æ€§ãŒä¸ŠãŒã‚‹ãã‚‰ã„ã§é–¢æ•°ã«ã™ã‚‹å¿…è¦ãªã„ã®ã‹ï¼Ÿ)
        // åŒã˜ã€ã¾ãŸã¯ä¼¼é€šã£ãŸå‡¦ç†ã‚’è¤‡æ•°æ›¸ã„ã¦ã„ã‚‹ã¨ã“ã‚ã€ã‚¤ãƒ™ãƒ³ãƒˆã‚»ãƒ¬ã‚¯ã‚¿ãŒé•·ã„ã¨ã“ã‚ã¨ã‹ä¿®æ­£ã§ããŸã‹ã‚‚

        // æ•µãŒãƒ©ãƒ³ãƒ€ãƒ ã«æ‰‹æœ­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’å‡ºã™å‡¦ç†

        // å‡ºã•ã‚ŒãŸã‚«ãƒ¼ãƒ‰ã§å‹æ•—ã®åˆ¤å®šã¨åŠ¹æœå‡¦ç†

    </script>
</body>

</html>